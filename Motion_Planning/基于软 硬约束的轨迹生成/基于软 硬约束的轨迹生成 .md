# åŸºäºè½¯/ç¡¬çº¦æŸçš„è½¨è¿¹ç”Ÿæˆ

## é—®é¢˜æå‡º

### å­˜åœ¨çš„é—®é¢˜

åŸºäºminimum snapç”Ÿæˆçš„è½¨è¿¹ï¼Œæˆ‘ä»¬æ§åˆ¶çš„æ˜¯waypointï¼Œä½†æ˜¯åœ¨è½¨è¿¹ç”Ÿæˆçš„æ—¶å€™å¯èƒ½å‡ºç°â€œovershootâ€çš„ç°è±¡ï¼Œäº§ç”Ÿç¢°æ’ã€‚

![](https://pic4.zhimg.com/80/v2-62bd034496177c28bf8ff742cfed8d6c.png)
### è§£å†³æ€è·¯

- åœ¨éšœç¢ç‰©ä¸ŠåŠ â€æ¨åŠ›â€œ

![](https://pic4.zhimg.com/80/v2-afa115bee9c7af39344083a47a2b5bff.png)

- åœ¨å¯é€šè¡ŒåŒºåŸŸåŠ çº¦æŸ

![](https://pic4.zhimg.com/80/v2-48e61b5cf236a5201370cb0cf12083db.png)

é€šå¸¸å°†ç¬¬ä¸€ç§æƒ…å†µå˜æˆã€è½¯çº¦æŸã€‘çš„ä¼˜åŒ–é—®é¢˜ï¼Œå°†ç¬¬äºŒç§æƒ…å†µå˜æˆã€ç¡¬çº¦æŸã€‘çš„ä¼˜åŒ–é—®é¢˜

### ç¡¬/è½¯çº¦æŸçš„æ¦‚å¿µ

- ç¡¬çº¦æŸ

åœ¨æ•´ä¸ªxçš„å®šä¹‰åŸŸå†…ï¼Œéƒ½è¦ã€ä¸¥æ ¼æ»¡è¶³ç­‰å¼çº¦æŸå’Œä¸ç­‰å¼çº¦æŸã€‘

$$
\begin{matrix}\min&\quad f\left(x\right)\\ s.f.&\quad g_i\left(x\right)=c_i,\quad i=1,\cdots,n\quad\text{Equality constants}\\ &\quad h_j\left(x\right)\ge d_j,\quad j=1,\cdots,n\quad\text{ bluequality constraints}\end{matrix}
$$

- è½¯çº¦æŸ

å°†ç­‰å¼çº¦æŸå’Œä¸ç­‰å¼çº¦æŸèå…¥äº†ç›®æ ‡å‡½æ•°ä¸­

$$
\text{min}\quad f(x)+\lambda_1\cdot g(x)+\lambda_2\cdot h(x)
$$

ä½¿ç»“æœå€¾å‘äºæ»¡è¶³çº¦æŸæ¡ä»¶ï¼Œè€Œä¸æ˜¯ä¸¥æ ¼è¢«æ»¡è¶³ï¼Œ$\lambda_1\cdot g(x)+\lambda_2\cdot h(x)$è¢«ç§°ä¸ºæƒ©ç½šé¡¹/æŸå¤±å‡½æ•°(loss function)ï¼Œæœ‰å¾ˆå¤šç§å¸¸è§çš„loss functionï¼Œæ¯”å¦‚:

![](https://pic4.zhimg.com/80/v2-cfcb2b0fcd51fd7d6425d1cdb8d56874.png)

## ç¡¬çº¦æŸ

### Corridor based Trajectory Optimization

#### æ¡†æ¶

1. å°†ç¯å¢ƒä¿¡æ¯è½½å…¥[å…«å‰æ ‘åœ°å›¾](https://blog.csdn.net/qq_37394634/article/details/105000506?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167655202216800188596968%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167655202216800188596968&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-105000506-null-null.142^v73^insert_down4,201^v4^add_ask,239^v2^insert_chatgpt&utm_term=%E5%85%AB%E5%8F%89%E6%A0%91%E5%9C%B0%E5%9B%BE&spm=1018.2226.3001.4187)
2. ç”¨path-findingçš„æ–¹æ³•ï¼Œåœ¨åœ°å›¾ä¸Šæœç´¢å‡ºä¸€æ¡å®‰å…¨çš„è·¯å¾„ï¼ˆå®‰å…¨èµ°å»Šï¼‰
3. å°†å®‰å…¨èµ°å»Šåœ¨åœ°å›¾ä¸­è¿›è¡Œè†¨èƒ€
4. åœ¨è†¨èƒ€åçš„å®‰å…¨èµ°å»Šä¸­è¿›è¡Œè½¨è¿¹ç”Ÿæˆ

![](https://pic4.zhimg.com/80/v2-c0817ed92f0e1182abb269df133af62e.png)

#### è½¨è¿¹ç”Ÿæˆ

- åˆ†æ®µå¤šé¡¹å¼è½¨è¿¹å‡½æ•°ä¸minimum snapå’Œminimum jerkæ˜¯ä¸€æ ·çš„ï¼š

$$
f_\mu(t)=\begin{cases} \sum_{j=0}^N p_{1J}(t-T_0)^J&T_0\leq t\leq T_1\\ \sum_{J=0}^N p_{2J}(t-T_1)^J&T_0\leq t\leq T_1\\ \vdots&\vdots&\vdots\\ \sum_{J=0}^N p_{MJ}(t-T_{M-1})^J&T_0\leq t\leq T_1\end{cases}
$$

- ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°ä¹Ÿæ˜¯ä¸€æ ·çš„

$$
J=\sum_{\mu\in\{x,y,z\}}\int_{0}^{T}\left(\frac{d^{k}f_{\mu}(t)}{d t^{k}}\right)^{2}d t
$$

- çº¦æŸæ¡ä»¶æœ‰æ‰€ä¸åŒ

ç”±äºæˆ‘ä»¬æ˜¯åœ¨å®‰å…¨èµ°å»Šé‡Œè¿›è¡Œä¼˜åŒ–çš„ï¼Œå¹¶æ²¡æœ‰æŒ‡å®šwaypointï¼Œå› æ­¤waypointçš„å¯¼æ•°çº¦æŸæ˜¯æ²¡æœ‰çš„ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å®‰å…¨æ€§çº¦æŸï¼Œå…·ä½“çš„çº¦æŸæœ‰ï¼š

- Instant linear constraints::

> èµ·ç‚¹å’Œç»ˆç‚¹çš„çŠ¶æ€çº¦æŸ($Ap=b$)
> 

> Transition point çš„çº¦æŸ($Ap=b,Apâ‰¤b$)
> 

æˆ‘ä»¬å¸Œæœ›åœ¨æ¯ä¸ªå‡¸åŒ…å†…ç”Ÿæˆçš„è½¨è¿¹éƒ½æ˜¯è¢«boundåœ¨å‡¸åŒ…å†…çš„ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä»¶æ¯”è¾ƒå›°éš¾çš„äº‹æƒ…ï¼Œå¯ä»¥å…ˆè¿™æ ·åšï¼Œå°†åˆ†æ®µçš„è½¨è¿¹çš„è¿æ¥ç‚¹(Transition point)ï¼Œboundåœ¨ä¸¤ä¸ªå‡¸åŒ…çš„å…¬å…±åŒºåŸŸå†…ã€‚

![](https://pic4.zhimg.com/80/v2-fbc823c78191afec5799391b61a37a1b.png)

ä½†æ˜¯è¿™æ ·åšä¹Ÿæ˜¯ä¸å¤Ÿçš„ï¼Œè½¨è¿¹ä¹Ÿå¯èƒ½è½åœ¨å‡¸åŒ…å¤–é¢ï¼Œå®‰å…¨æ€§ä¸å®Œå¤‡

![](https://pic4.zhimg.com/80/v2-d7390aaa8c1d279a60475cf68f25dfd6.png)

> è¿ç»­æ€§çº¦æŸ($Ap_i=b_i$)
> 
- Interval linear constraints:

> è¾¹ç•Œçº¦æŸ($\textbf{A}(t)\textbf{p}\leq\textbf{b},\forall t\in[t_l,t_r]$)ï¼Œæ•´æ¡è½¨è¿¹çš„è¾¹ç•Œçº¦æŸæ˜¯å¾ˆéš¾æ–½åŠ çš„ï¼Œé™¤éå°†Tç¦»æ•£åŒ–éå¸¸ç»†ï¼Œç„¶åè¿›è¡Œçº¦æŸï¼Œä½†æ˜¯è¿™æ ·ä¼šå¤§å¤§å¢åŠ å‡¸ä¼˜åŒ–é—®é¢˜çš„çº¦æŸæ•°é‡ï¼Œå¯¼è‡´æ±‚è§£éå¸¸å›°éš¾ï¼Œé€šå¸¸é‡‡å–åéªŒçš„æ–¹å¼
> 

> åŠ¨åŠ›å­¦çº¦æŸ($\textbf{A}(t)\textbf{p}\leq\textbf{b},\forall t\in[t_l,t_r]$)ï¼Œå’Œè¾¹ç•Œçº¦æŸåŒæ ·çš„é—®é¢˜ï¼Œéš¾ä»¥æ–½åŠ ï¼Œé€šå¸¸é‡‡å–åéªŒçš„æ–¹å¼
> 
- ä¼˜ç‚¹ï¼šæ•ˆç‡éå¸¸é«˜ï¼Œè´¨é‡éå¸¸é«˜ï¼Œç”±äºæ²¡æœ‰äº†waypointè¿™ç§fixedçš„ç‚¹ï¼Œä¼˜åŒ–çš„è‡ªç”±åº¦è¢«å¤§å¤§å¢åŠ äº†ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ‰¾åˆ°æœ€ä¼˜çš„Transition pointï¼Œè€Œä¸”å¯ä»¥éšå¼çš„è°ƒèŠ‚æ—¶é—´åˆ†é…çš„é—®é¢˜ï¼Œåœ¨fixedçš„waypointçš„æ—¶å€™å¦‚æœTåˆ†é…ä¸å¥½ï¼Œå¾—åˆ°çš„è½¨è¿¹ä¹Ÿä¸æ˜¯å¾ˆå¥½ï¼Œè€Œç°åœ¨pointæ˜¯å¯ä»¥åœ¨å‡¸åŒ…äº¤é›†é‡ŒåŠ¨çš„ï¼Œå› æ­¤å¯ä»¥éšå¼çš„è°ƒèŠ‚æ—¶é—´åˆ†é…å¸¦æ¥çš„å½±å“

![](https://pic4.zhimg.com/80/v2-52b46a814694734099bc7b12f8a489d0.png)

- é—®é¢˜ï¼Œå…¨å±€è¾¹ç•Œå’ŒåŠ¨åŠ›å­¦çš„intervalçš„çº¦æŸæ˜¯å¾ˆéš¾æ–½åŠ çš„
- è§£å†³æ–¹æ³•ï¼š

åœ¨è½¨è¿¹ç”Ÿæˆä¹‹ååšæ£€æŸ¥ï¼Œä¸éœ€è¦å°†tç¦»æ•£åŒ–é€ä¸ªæ£€æŸ¥ï¼Œæ£€æŸ¥æå€¼å³å¯ï¼Œå¦‚æœè¶…è¿‡è¾¹ç•Œï¼Œç»§ç»­æ–½åŠ æ–°çš„çº¦æŸï¼Œå°†æå€¼å¾€ä¸‹å‹ï¼Œå¯ä»¥æ”¶ç´§ä¸€äº›çº¦æŸï¼Œç„¶åè¿­ä»£æ£€æŸ¥ï¼Œçº¦æŸï¼Œæ±‚è§£ï¼Œéœ€è¦å¤šæ¬¡æ±‚è§£QPï¼Œå¯¹åœ¨çº¿æ±‚è§£é€Ÿåº¦æ–½åŠ äº†å‹åŠ›ï¼Œè€Œä¸”æœ‰æ²¡æœ‰è§£ï¼Œéƒ½éœ€è¦è¿›è¡Œå¤šæ¬¡è¿­ä»£æ‰èƒ½çœ‹å‡ºã€‚

![](https://pic4.zhimg.com/80/v2-6e9db1bd0722dfc85b0560933d558e42.png)

## **Bezier Curve Optimization**

### ä»æ™®é€šå¤šé¡¹å¼æ›²çº¿è½¬åˆ°è´å¡å°”æ›²çº¿

ç”¨Bernstein polynomialä»£æ›¿monomial polynomialï¼Œ[è´å¡å°”æ›²çº¿](https://www.zhihu.com/search?type=content&q=%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF)

$$
\begin{array}{c}{{B_{j}(t)=c_{j}^{0}b_{n}^{0}(t)+c_{j}^{1}b_{n}^{1}(t)+\cdots+c_{j}^{n}b_{n}^{n}(t)=\sum_{i=0}^{n}c_{j}^{i}b_{n}^{i}(t)}}\\ {{b_{n}^{i}(t)={\binom{n}{i}}\cdot t^{i}\cdot(1-t)^{n-i}}}\end{array}
$$

monomial polynomialå„é˜¶çš„ç³»æ•°å’ŒBernstein polynomialå„é˜¶ç³»æ•°æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œ$p = M c$ 

$$
For 6 order:
\mathbf{M}=\left[\begin{array}{ccccccc}1 & 0 & 0 & 0 & 0 & 0 & 0 \\-6 & 6 & 0 & 0 & 0 & 0 & 0 \\15 & -30 & 15 & 0 & 0 & 0 & 0 \\-20 & 60 & -60 & 20 & 0 & 0 & 0 \\15 & -60 & 90 & -60 & 15 & 0 & 0 \\-6 & 30 & -60 & 60 & -30 & 6 & 0 \\1 & -6 & 15 & -20 & 15 & -6 & 1\end{array}\right]
$$

#### è´å¡å°”æ›²çº¿æ€§è´¨

- **Endpoint interpolationï¼š**è´å¡å°”æ›²çº¿æ€»æ˜¯ä»ç¬¬ä¸€ä¸ªæ§åˆ¶ç‚¹å¼€å§‹ï¼Œåœ¨æœ€åä¸€ä¸ªæ§åˆ¶ç‚¹ç»“æŸï¼Œæ°¸è¿œä¸ç»è¿‡ä»»ä½•å…¶ä»–æ§åˆ¶ç‚¹ã€‚
- **Convex hullï¼š**è´å¡å°”æ›²çº¿ ğµ(ğ‘¡) å®Œå…¨è¢«é™åˆ¶åœ¨ä¸€ç»„æ§åˆ¶ç‚¹ ci ç»„æˆçš„å‡¸åŒ…å†…ï¼Œè¿™å°±è§£å†³äº†ä¹‹å‰è½¨è¿¹ä¸èƒ½å®Œå¤‡çš„è¢«å‡¸åŒ…boundä½çš„é—®é¢˜ï¼
- **Hodographï¼š**è´å¡å°”æ›²çº¿çš„å¯¼æ•°ä»ç„¶æ˜¯è´å¡å°”æ›²çº¿ï¼Œè€Œä¸”å¯¼æ•°çš„æ§åˆ¶ç‚¹ï¼Œå¯ä»¥è¢«åŸå‡½æ•°çš„æ§åˆ¶ç‚¹çº¿æ€§è¡¨ç¤ºï¼Œè€Œä¸”å°±ç­‰äº$ğ‘›\times(ğ‘_{i+1} âˆ’ ğ‘_{ğ‘–})$ï¼Œè¿™æ ·å¯¹å¯¼æ•°çš„æ§åˆ¶ç‚¹çš„çº¦æŸï¼Œå°±å¯ä»¥åŠ åœ¨åŸå‡½æ•°ä¸Šã€‚
- **Fixed time intervalï¼š**æ¯ä¸€æ®µæ›²çº¿çš„æ—¶é—´é—´éš”ä¸€å®šæ˜¯åœ¨$[0,1]$ä¹‹é—´çš„ï¼Œè¿™æ˜¯ä»–çš„ä¸€ä¸ªç¼ºç‚¹ï¼Œéœ€è¦ç”¨æ—¶é—´æ˜ å°„æ¥ï¼Œå°†0-1æ˜ å°„åˆ°Tã€‚

![](https://pic4.zhimg.com/80/v2-3e476a8a2ae7857a9cf5f87ed0917420.png)

#### åˆ©ç”¨è´å¡å°”æ›²çº¿çš„å‡¸åŒ…æ€§è´¨è§£å†³ä¹‹å‰çš„é—®é¢˜

- æŠŠè´å¡å°”æ›²çº¿çš„æ§åˆ¶ç‚¹æ”¾åœ¨ä¹‹å‰çš„çŸ©å½¢å‡¸åŒ…å†…ï¼Œè¿™æ ·æ§åˆ¶ç‚¹ç”Ÿæˆçš„å‡¸åŒ…ä¸€å®šåœ¨çŸ©å½¢å‡¸åŒ…é‡Œï¼Œè¿›è€Œæ›²çº¿è¢«çŸ©å½¢å‡¸åŒ…boundä½äº†ï¼ä¸éœ€è¦å°†Tç¦»æ•£åŒ–éå¸¸ç»†ï¼Œç„¶åè¿›è¡Œçº¦æŸï¼Œåªéœ€è¦å°†æ§åˆ¶ç‚¹çº¦æŸåœ¨å‡¸åŒ…å†…ï¼Œå¢åŠ çº¦æŸçš„ä¸ªæ•°ç­‰äºè´å¡å°”æ›²çº¿é˜¶æ•°+1ï¼Œå¤§å¤§å‡å°‘çº¦æŸçš„ä¸ªæ•°ã€‚

![](https://pic4.zhimg.com/80/v2-cdf45f166da2c26616ae750f1c8b404c.png)

- ç”±äºè´å¡å°”æ›²çº¿çš„å¯¼æ•°ä¹Ÿæ˜¯è´å¡å°”æ›²çº¿ï¼Œå¯¼æ•°ä¹Ÿå¯ä»¥è¢«å¯¼æ•°çš„æ§åˆ¶ç‚¹boundåœ¨å‡¸åŒ…å†…ï¼Œè€Œä¸”è¿˜å¯ä»¥è½¬åŒ–æˆå¯¹æ›²çº¿çš„æ§åˆ¶ç‚¹çš„çº¦æŸï¼Œè¿™æ ·åŠ¨åŠ›å­¦çº¦æŸä¹Ÿè¢«æ»¡è¶³äº†ã€‚

![](https://pic4.zhimg.com/80/v2-213ec5f5b94b1d642954da1d5bd842d4.png)

### åŸºäºè´å¡å°”æ›²çº¿çš„ä¼˜åŒ–

*l*é˜¶æ§åˆ¶ç‚¹çš„å½¢å¼ï¼š$a_{\mu j}^{l,i}$è¡¨ç¤º$\mu$æ–¹å‘ä¸Šçš„ç¬¬$j$æ¡è½¨è¿¹çš„$l$é˜¶å¯¼æ•°çš„ç¬¬$i$ä¸ªæ§åˆ¶ç‚¹

$$
a_{\mu j}^{0,i}=c_{\mu j}^{i},a_{\mu j}^{l,i}=\frac{n!}{(n-l)!}\cdot(a_{\mu j}^{l-1,i+1}-a_{\mu j}^{l-1,i}),l\geq1
$$

- èµ·ç‚¹å’Œç»ˆç‚¹çº¦æŸ

$$
a^{l,0}_{\mu j}\cdot s^{(1-l)}_{j}=d^{(l)}_{\mu j}
$$

ä¹‹å‰å¯¹èµ·ç‚¹å’Œç»ˆç‚¹çš„çº¦æŸéƒ½æ˜¯å°†æ—¶é—´t = 0ï¼ŒTå¸¦å…¥è½¨è¿¹ä½¿è¡¨è¾¾å¼çš„å€¼ç­‰äºæœŸæœ›çš„èµ·ç‚¹å’Œç»ˆç‚¹çš„å„é˜¶å¯¼æ•°å€¼ï¼Œç”±äºè´å¡å°”æ›²çº¿å…·æœ‰ä¸€å®šç»è¿‡ç¬¬ä¸€ä¸ªæ§åˆ¶ç‚¹å’Œæœ€åä¸€ä¸ªæ§åˆ¶ç‚¹çš„æ€§è´¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†ç¬¬ä¸€ä¸ªæ§åˆ¶ç‚¹ç›´æ¥é…ç½®åœ¨èµ·ç‚¹ï¼Œå°†æœ€åä¸€ä¸ªæ§åˆ¶ç‚¹ç›´æ¥é…ç½®åœ¨ç»ˆç‚¹ï¼Œå¯¹äºé€Ÿåº¦å’ŒåŠ é€Ÿåº¦çš„è´å¡å°”æ›²çº¿ä¹Ÿæ˜¯ä¸€æ ·ï¼Œç›´æ¥é…ç½®åœ¨é€Ÿåº¦çš„èµ·ç‚¹å’Œç»ˆç‚¹ï¼ŒåŠ é€Ÿåº¦ç­‰ä¹Ÿæ˜¯åŒç†ã€‚

- è¿ç»­æ€§çº¦æŸ

$$
a_{\mu j}^{\phi,n}\cdot s_j^{(1-\phi)}=a_{\mu,j+1}^{\phi,0}\cdot s_{j+1}^{(1-\phi)},a_{\mu j}^{0,i}=c_{\mu j}^i
$$

åŒæ ·é“ç†ï¼Œå¯¹äºè¿ç»­æ€§çº¦æŸï¼Œå¯ä»¥ç›´æ¥å°†å‰ä¸€æ®µæ›²çº¿çš„æœ€åä¸€ä¸ªæ§åˆ¶ç‚¹ï¼Œå’Œä¸‹ä¸€æ®µè½¨è¿¹çš„ç¬¬ä¸€ä¸ªæ§åˆ¶ç‚¹é…ç½®åœ¨ä¸€èµ·

- è¾¹ç•Œçº¦æŸï¼ˆå®‰å…¨æ€§çº¦æŸï¼‰ï¼š

$$
\beta_{\mu j}^{-}\leq c_{\mu j}^{i}\leq\beta_{\mu j}^{+},\mu\in\{x,y,z\},i=0,1,2,...,n
$$

åˆ©äºè´å¡å°”æ›²çº¿çš„å‡¸åŒ…æ€§è´¨ï¼Œå°†æ§åˆ¶ç‚¹é…ç½®åœ¨å®‰å…¨èµ°å»Šçš„çŸ©å½¢å‡¸åŒ…å†…ï¼Œè¿›è€Œæ›²çº¿ä¹Ÿè¢«å®Œå…¨é™åˆ¶åœ¨å‡¸åŒ…å†…

- åŠ¨åŠ›å­¦çº¦æŸ

$$
\begin{array}{l}{{v_{m}^{-}\leq n\cdot(c_{\mu j}^{i}-c_{\mu j}^{i-1})\leq v_{m}^{+},}}\\ {{a_{m}^{-}\leq n\cdot(n-1)\cdot(c_{\mu j}^{i}-2c_{\mu j}^{i-1}+c_{\mu j}^{i-2})/s_{j}\leq a_{m}}}\end{array}
$$

åŒç†åˆ©ç”¨é€Ÿåº¦æ›²çº¿çš„æ§åˆ¶ç‚¹å°†é€Ÿåº¦æ›²çº¿æ§åˆ¶åœ¨å‡¸åŒ…å†…ï¼ŒåŠ é€Ÿåº¦ä¹Ÿä¸€æ ·ï¼Œè¿™æ ·åŠ¨åŠ›å­¦çº¦æŸä¹Ÿè¢«æ»¡è¶³äº†

è‡³æ­¤ï¼Œä¼˜åŒ–é—®é¢˜è½¬åŒ–æˆäº†å¦‚ä¸‹çš„å½¢å¼ï¼šå½»åº•é¿å…äº†å¤šæ¬¡è¿­ä»£æ±‚è§£çš„é—®é¢˜ï¼

![](https://pic4.zhimg.com/80/v2-8657119d1b89880900b508155d09b834.png)

## è½¯çº¦æŸ

 åœ¨éšœç¢ç‰©ä¸ŠåŠ â€æ¨åŠ›â€œï¼Œä½¿æœºå™¨äººè¿œç¦»éšœç¢ç‰©

### è½¯çº¦æŸçš„åŠ¨æœº

åœ¨ç¡¬çº¦æŸä¸­ï¼Œå°†æ•´ä¸ªç¯å¢ƒåˆ†ä¸ºäº†æœ‰éšœç¢ç‰©å’Œæ²¡æœ‰éšœç¢ç‰©ä¸¤ç§ï¼Œåœ¨å®‰å…¨åŒºåŸŸå†…ï¼Œç¡¬çº¦æŸå€¾å‘äºå°†æ‰€æœ‰çš„ç‚¹éƒ½çœ‹æˆæ˜¯ç­‰ä»·çš„ï¼Œæœ€åç”Ÿæˆçš„è½¨è¿¹æœ‰äº›éƒ¨åˆ†å¯èƒ½ä¼šç¦»éšœç¢ç‰©å¾ˆè¿‘ï¼Œç”±äºæ§åˆ¶ç­‰ä¼šå‡ºç°è¯¯å·®ï¼Œå¯¼è‡´æœºå™¨äººå¯èƒ½ä¼šç¢°åˆ°éšœç¢ç‰©ï¼Œæ­¤å¤–ç¡¬çº¦æŸæ˜¯ä¾é å®‰å…¨èµ°å»Šè¿›è¡Œçš„è½¨è¿¹ç”Ÿæˆï¼Œç”±äºæ„ŸçŸ¥ç­‰è¯¯å·®ï¼Œå¯èƒ½ä¼šå‡ºç°å®‰å…¨èµ°å»Šè´¨é‡è¾ƒå·®çš„æƒ…å†µã€‚

![](https://pic4.zhimg.com/80/v2-efd62814dbd1525105582aca1982f62c.png)

### åŸºäºè·ç¦»çš„è½¯çº¦æŸè½¨è¿¹ä¼˜åŒ–

- åˆ†æ®µå¤šé¡¹å¼è½¨è¿¹çš„è¡¨è¾¾å¼å’Œä¹‹å‰ç±»ä¼¼ï¼š

$$
f_{\mu}(t)=\left\{\begin{array}{l l}{{\sum_{j=0}^{N}p_{1j}(t-T_{0})^{j}}}&{{T_{0}\leq t\leq T_{1}}}\\ {{\sum_{j=0}^{N}p_{2j}(t-T_{1})^{j}}}&{{T_{0}\leq t\leq T_{1}}}\\ {{\vdots}}&{{\vdots}}\\ {{\sum_{j=0}^{N}p_{Mj}(t-T_{M-1})^{j}}}&{{T_{0}\leq t\leq T_{1}}}\end{array}\right.
$$

- ç›®æ ‡å‡½æ•°

$$
\begin{split}J& =J_s+J_c+J_d \\& =\lambda _1J_1(smoothness\ cost)+\lambda _2J_2(collision\ cost)+\lambda _3J_3(Dynamical\ cost)\end{split}
$$

$\lambda_1,\lambda_2,\lambda_3$åˆ†åˆ«æ˜¯å„ä¸ªæƒ©ç½šé¡¹çš„æƒé‡ç³»æ•°

> Smoothness Cost
> 

$$
\begin{aligned}J_{s} & =\sum_{\mu \in\{x, y, z\}} \int_{0}^{T}\left(\frac{d^{k} f_{\mu}(t)}{d t^{k}}\right)^{2} d t \\& =\left[\begin{array}{l}\boldsymbol{d}_{F} \\\boldsymbol{d}_{P}\end{array}\right]^{T} \boldsymbol{C}^{T} \boldsymbol{M}^{-T} \boldsymbol{Q} \boldsymbol{M}^{-1} \boldsymbol{C}\left[\begin{array}{l}\boldsymbol{d}_{F} \\\boldsymbol{d}_{P}\end{array}\right]=\left[\begin{array}{l}\boldsymbol{d}_{F} \\\boldsymbol{d}_{P}\end{array}\right]^{T}\left[\begin{array}{ll}\boldsymbol{R}_{F F} & \boldsymbol{R}_{F P} \\\boldsymbol{R}_{P F} & \boldsymbol{R}_{P P}\end{array}\right]\left[\begin{array}{l}\boldsymbol{d}_{F} \\\boldsymbol{d}_{P}\end{array}\right]\end{aligned}
$$

> Collision Cost
> 

è·ç¦»åœº(ESDF):

![](https://pic4.zhimg.com/80/v2-bf49f8631cd58797eba96fb35fa97e75.png)

æ²¿ç€è½¨è¿¹å°†å„ä¸ªç‚¹åœ¨è·ç¦»åœº(ESDF)ä¸­çš„æ•°å€¼(ç¦»æœ€è¿‘çš„éšœç¢ç‰©çš„è·ç¦»)è¿›è¡Œç§¯åˆ†ï¼Œè¿™é‡Œçš„ç§¯åˆ†æ˜¯å¯¹æ›²çº¿ç§¯åˆ†ï¼Œ$ds$ç”¨$\left | \left | v(t) \right |Â  \right |\delta (t)$Â è¿‘ä¼¼æ›¿ä»£

$$
\begin{aligned}J_{c} & =\int_{T_{0}}^{T_{M}} c(p(t)) d s \\& =\sum_{k=0}^{T / \delta t} c\left(p\left(T_{k}\right)\right)\|v(t)\| \delta t, T_{k}=T_{0}+k \delta t\end{aligned}
$$

å„ä¸ªç‚¹åœ¨è·ç¦»åœºä¸­çš„æ•°å€¼æ˜¯æ²¡æ³•å†™æˆå…³äºè½¨è¿¹çš„å‡½æ•°çš„å½¢å¼ï¼Œåªèƒ½å°†è½¨è¿¹ç¦»æ•£åŒ–æ±‚å‡ºå„ä¸ªç‚¹åœ¨è·ç¦»åœºä¸­çš„æ•°å€¼æ¥ç€ç®—å‡ºæƒ©ç½šçš„å¤§å°ï¼Œç„¶åè¿›è¡Œæ±‚å’Œï¼Œ cæ˜¯è®¾è®¡çš„æƒ©ç½šå‡½æ•°ï¼Œé‡Œéšœç¢ç‰©è¶Šè¿‘æƒ©ç½šè¶Šå¤§ï¼Œå›¾ç¤ºæ˜¯ä¸€ç§æŒ‡æ•°çš„æƒ©ç½šå‡½æ•°

![](https://pic4.zhimg.com/80/v2-87a1ba1f7dd15f7f2b621b9553cda8e9.png)

> Dynamical Cost: å¯¹é€Ÿåº¦å’ŒåŠ é€Ÿåº¦çš„æƒ©ç½šï¼Œå’Œç¢°æ’æƒ©ç½šç±»ä¼¼ï¼Œä¹Ÿæ˜¯éœ€è¦ç¦»æ•£åŒ–å†æ±‚å’Œ
> 

![](https://pic4.zhimg.com/80/v2-668e5aee8252d8c7a0097401c8d4edbc.png)

- æ±‚è§£

è¿™æ ·çš„ä¼˜åŒ–é—®é¢˜ä¸æ˜¯å‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå› ä¸ºéšœç¢ç‰©å½¢çŠ¶å„å¼‚ï¼Œè·ç¦»åœºä¸æ˜¯ä¸€ä¸ªå‡¸ç©ºé—´ï¼Œå› æ­¤åªèƒ½æŒ‰ç…§éçº¿æ€§ä¼˜åŒ–çš„æ–¹å¼ï¼Œé€šè¿‡ç›®æ ‡å‡½æ•°å¯¹ä¼˜åŒ–å˜é‡$d_{p\mu}$æ±‚å¯¼ï¼Œå†è¿›è¡Œæ•°å€¼æ±‚è§£ï¼Œå„é¡¹Costå¯¼æ•°å¦‚ä¸‹ï¼š

> Smoothness Cost
> 

$$
\frac{\alpha J_s}{\alpha\boldsymbol d_{p\mu}}=2\boldsymbol d_F^T\boldsymbol R_{FP}+2\boldsymbol d_P^T\boldsymbol R_{PP}
$$

> Collision Cost
> 

$$
\frac{\alpha J_{c}}{\alpha d_{p,u}}=\sum_{k=0}^{T/\delta t}\left\{\forall_{\mu}c\big(p(T_{k})\big)\|v\|F+c\big(p(T_{k})\big)\frac{v_{\mu}}{\|v\|}{G}\right\}\delta t,\mu\in\{x,y,z\}
$$

å°è¯•æ¨å¯¼ä¸€ä¸‹ï¼Œ$c\left(p\left(T_{k}\right)\right)\|v(t)\| \delta t$å¯¹$d_{p\mu}$æ±‚å¯¼ï¼Œç”±äº$\delta t$æ˜¯ç¦»æ•£æ­¥é•¿ï¼Œä¸ºå¸¸æ•°ï¼Œå› æ­¤æ²¡æœ‰å½±å“ã€‚

$$
\frac{\mathrm{d} [c\left(p\left(T_{k}\right)\right)\|v(t)\|]}{\mathrm{d} d_p\mu } = \frac{\mathrm{d} [c\left(p\left(T_{k}\right)\right] }{\mathrm{d} d_p\mu }\|v(t)\|+c\left(p\left(T_{k}\right)\right)\frac{\mathrm{d} \|v(t)\| }{\mathrm{d} d_p\mu } 
$$

- ç¬¬ä¸€é¡¹

æ ¹æ®å¤åˆå‡½æ•°æ±‚å¯¼é“¾å¼æ³•åˆ™ï¼š

$$
\frac{\mathrm{d} [c\left(p\left(T_{k}\right)\right)]}{\mathrm{d} d_p\mu }\|v(t)\| = \frac{\mathrm{d} [c(p(T_k))]}{\mathrm{d} p(T_k)}\times \frac{\mathrm{d} p(T_k)}{\mathrm{d} d_{p\mu }}\times \|v(t)\| 
$$

$\frac{\mathrm{d} c(p(T_k))}{\mathrm{d} p(T_k)}$æ˜¯ç¢°æ’æƒ©ç½šå‡½æ•°$c$åœ¨$\mu$æ–¹å‘ä¸Šçš„æ¢¯åº¦ï¼Œè®°ä¸º$\forall _\mu c(\cdot)$

$p(T_k)$æ˜¯$T_k$æ—¶åˆ»çš„ä½ç½®ï¼Œä¸‹å¼ä¸­çš„$p_i$æ˜¯è½¨è¿¹å‚æ•°

$$
\begin{split}
p(T_k)
& = \left [T_k^0,T_k^1,\dots ,T_k^n \right ] \left [p_0,p_1,\dots,p_n  \right ] ^ T \\
& = \left [T_k^0,T_k^1,\dots ,T_k^n \right ] M^{-1}C\begin{bmatrix}
d_F\\
d_P
\end{bmatrix}  
\end{split}
$$

è®°ï¼Œ$T= \left [T_k^0,T_k^1,\dots ,T_k^n \right ]$ ï¼Œä¸ºå¸¸é‡ï¼ŒæŠŠÂ $M^{-1}C$å†™æˆåˆ†å—çŸ©é˜µ$\left [L_{df},L_{dp}  \right ]$ ï¼Œåˆ™

$$
\begin{split}p(T_k)& = T \left [ L_{df},L_{dp} \right ] \begin{bmatrix}d_F\\d_P\end{bmatrix}=T(L_{df}d_F+L_{dp}d_P)\end{split}
$$

å› ä¸º$TL_{dp}d_P$æ˜¯å¸¸é‡ï¼Œå› æ­¤

$$
\frac{\mathrm{d} p(T_k)}{\mathrm{d} d_{p\mu }} = TL_{dp}=F
$$

æ‰€ä»¥ç¬¬ä¸€é¡¹ç­‰äº

$$
\forall_{\mu}c\big(p(T_{k})\big)\|v\|F
$$

- ç¬¬äºŒé¡¹

æ ¹æ®å¤åˆå‡½æ•°æ±‚å¯¼é“¾å¼æ³•åˆ™ï¼š

$$
\begin{split}
c\left(p\left(T_{k}\right)\right)\frac{\mathrm{d} \|v(t)\| }{\mathrm{d} d_p\mu } = c\left(p\left(T_{k}\right)\right) \times \frac{\mathrm{d} \|v\|}{\mathrm{d} v_\mu} \times \frac{\mathrm{d} v_\mu}{\mathrm{d} d_{p\mu}} 
\end{split}
$$

$\|v\| = (v_x^2+v_y^2+v_z^2)^{\frac{1}{2}}$ï¼Œ$\mu \in \left \{ x,y,z \right \}$Â ,ä»¥$\|v\|$å¯¹$v_x$æ±‚å¯¼ä¸ºä¾‹

$$
\frac{\mathrm{d} \|v\|}{\mathrm{d} v_x}  = \frac{v_x}{\|v\|}
$$

å› æ­¤

$$
\frac{\mathrm{d} \|v\|}{\mathrm{d} v_\mu}  = \frac{v_\mu}{\|v\|}
$$

è€Œ

$$
\begin{split}
v_\mu
& = \left [T_k^0,T_k^1,\dots ,T_k^n \right ] V_M\left [p_0,p_1,\dots,p_n  \right ] ^ T \\
& = \left [T_k^0,T_k^1,\dots ,T_k^n \right ] V_M M^{-1}C\begin{bmatrix}
d_F\\
d_P
\end{bmatrix}  \\ &= TV_ML_{dp}d_P  \end{split}
$$

å› æ­¤

$$
\frac{\mathrm{d} v_\mu}{\mathrm{d} d_{p\mu }} = TV_ML_{dp}=G
$$

æ‰€ä»¥ç¬¬äºŒé¡¹ç­‰äº

$$
c\big(p(T_{k})\big)\frac{v_{\mu}}{\|v\|}{G}
$$

ç»¼åˆæ¥çœ‹ï¼š

$$
\frac{\alpha J_{c}}{\alpha d_{p,u}}=\sum_{k=0}^{T/\delta t}\left\{\forall_{\mu}c\big(p(T_{k})\big)\|v\|F+c\big(p(T_{k})\big)\frac{v_{\mu}}{\|v\|}{G}\right\}\delta t,\mu\in\{x,y,z\}
$$

### æ•°å€¼ä¼˜åŒ–

ä¼˜åŒ–æ— çº¦æŸç›®æ ‡å‡½æ•°

$$
\begin{array}{l}\text{minimize}f(x)\end{array}
$$

å¯»æ‰¾ä¸€ä¸ª$x$åºåˆ—ä½¿å…¶é€¼è¿‘å…¨å±€æœ€ä¼˜è§£

$$
f\bigl(x^{(k)}\bigr)\to p^\star
$$

æˆ–è€…ä½¿å…¶å¯¼æ•°ç­‰äº0

$$
\nabla f(x^{\star})=0
$$

- ä¸‹é™æ³•

![](https://pic4.zhimg.com/80/v2-278eb95bf223da08628e42b19fc194ee.png)

- çº¿æœç´¢

![](https://pic4.zhimg.com/80/v2-23a5aebe49a17a44b3cb0763fc6c66e6.png)
- ä¸€é˜¶æ–¹æ³•-æ¢¯åº¦ä¸‹é™æ³•

![](https://pic4.zhimg.com/80/v2-905d58eeea90645d80d798df2cbe8eef.png)

- äºŒé˜¶æ–¹æ³•-ç‰›é¡¿æ³•

![](https://pic4.zhimg.com/80/v2-c1835c2e7b55a3870d9811decf9a39db.png)

- äºŒé˜¶æ–¹æ³•-LMæ–¹æ³•

![](https://pic4.zhimg.com/80/v2-20ae069e6d9d97c730ab83b5d8b4c7f0.png)